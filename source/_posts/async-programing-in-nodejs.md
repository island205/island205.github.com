title: Node.js 异步编程
----

Node.js 基于 JavaScript 引擎 v8，是但线程的。Node.js 采用了与通常 Web 上的 JavaScript 异步编程的方式来处理会造成阻塞的I/O操作。在 Node.js 中读取文件、访问数据库、网络请求等等都有可能是异步的。对于 Node.js 新人或者从其他语言背景迁移到 Node.js  上的开发者来说，异步编程是比较痛苦的一部分。本章将由浅入深为大家讲解 Node.js 异步编程的方方面面。

首先我们先从一个具体的异步编程的例子说起。

## 获取多个 ip 所在地的天气信息

在 ip.json 这个文件中，有一个数组我们存放了若干个 ip 地址，分别来自不同的敌方的不同访问者，内容如下：

    // ip.json
    ['115.29.230.208', '180.153.132.38', '74.125.235.224', '91.239.201.98', '60.28.215.115']

希望可以每一个 ip 所在地当前的天气。将结果输出到 weather.json 这个文件中各式如下：

    // weather.json
    [
			{ip: '115.29.230.208', location: '杭州', 'weather': ''},
			{ip: '115.29.230.208', location: '杭州', 'weather': ''},
			{ip: '115.29.230.208', location: '杭州', 'weather': ''}
		]

整理思路，我们分成以下几步来完成：

- 读取 ip 地址；
- 根据 ip 地址获取 ip 所在地的地理位置；
- 根据地理位置查询当地的天气；
- 将结果写入到 weather.json 文件中。

## co

[co](https://github.com/tj/co) 是由 tj 发起的一个开源项目。目的在于利用 ECMAScript 6 的 Generator 和 Promise 特性来解决在 Node 中异步问题。